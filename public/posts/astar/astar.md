# A* Path Finding Algorithm
---
&nbsp;

### 할 필요는 없었지만 그래도 해보고 싶었어  

몇 해 전, 모 회사의 입사 시험에서 맞닥드린 후 언젠가는 손을 봤어야 할 놈이었다. 이놈은...  
'프론트 엔드 개발자가 이걸 해......?' 라는 근원적인 물음을 뒤로 하고, 12시간의 과제 제출 시간 후에 완성된 건  
최단 거리 또는 최장거리도 아닌 눈감고 거리를 배회하는 수준의 그 어떤 것이었다.  
아무튼 그 뒤로 이놈은 언젠가는... 꼭 손을 보고 싶었다. 아니 봐야만 했다...  
> **그렇지 않다면 난 왜 좀 더 나은 개발자가 되어보겠다며 온라인 알고리즘 프로그래밍 사이트를 기웃거리면서 머리를 쥐어짰겠는가**

그 뒤로 업무에 치여 쉽사리 뽀개볼 생각을 하지 못했었지만, 시간이 나면 유튜브에서 길찾기 알고리즘의 원리를 이해하려 노력했다.  
그럼에도 그 원리를 어느정도는 파악하는데는 꽤나 오랜 시간이 걸렸었다. 머리가 엄청 잘 돌아가는 녀석은 아닌듯...  
오랜시간 동안 이해하려 노력했던 것에 비하면, 그 핵심 원리는 간단했다. 실제 구현에도 꼬박 하루가 걸렸다. (휴일 내내 붙잡고 있었던 듯...)  

(물론 아직 이해하지 못하고 그냥 사용하기만 하는 것 도 있다. 왜 H 값을 구할 때 Manhattan 택시 거리 함수가 최적의 방식인지 같이 ...  
내 추측으로는 뉴욕은 계획 도시? 이기 때문에 블록화가 잘 되어 있고 한 지점에서 한 지점으로 이동하는 최단거리는 지점과 지점 사이의  
일직선이 아닌 삼각형의 외변의 합이겠거니...?  
(X2 - X1) + (Y2 - Y1)
)

&nbsp;
### 왜 이걸 이해못해서 유튜브 동영상만 몇십개를 본거지?

길찾기 알고리즘에는 여러가지 방법들이 있지만 내가 선택한 건 그 중에서도 가장 효율적인 원리로 최단거리를 탐색하는 A* 알고리즘이다.  
물론 다른 알고리즘이나 파생 알고리즘 들이 더 있을테지만 그 녀석들까지는... 다음에 보자...  
내가 파악한 핵심원리는 나무위키에도 나와있건만 빙빙 돌아왔다.  

```
현재 노드에서 부모 노드까지의 거리를 G
현재 노드에서 최종 목적지 노드까지의 거리를 H (Heuristic)
이 두 값을 더한 값을 F = G + H

시작노드에서부터 시작하여 벽을 제외한 인접한 모든 노드의 F 값을 계산,
그 중 가장 적은 F 값을 가진 노드로 이동하여 같은 작업을 반복한다.
그러다가 타겟 노드를 발견하면 종료
```

이해하고 나서 나무위키에 다시 방문해보니 짧지만 핵심정리가 잘 되어 있다.  
괜히 영어로 된 유튜브 동영상부터 시작해서 한참 해맷다...  
[나무위키](https://namu.wiki/w/A*%20%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98)  

&nbsp;
### 리팩토링 & 버전업

당분간 손은 안대겠지만서도... 그래도 손 볼 곳이 좀 있다.

```
* Heuristic function 최적화
* F Cose 재계산 로직
* 현재는 재탐색을 위해 클래스를 매번 초기화 해주고 있는데, 페이지 진입 시 처음 한번만 해주면 될 것 같다.
  * 맵만 초기화 해주는게 귀찮아서 일단 이렇게 했는데 모든 노드 정보를 가지고 있는 Astar 클래스 인스턴스는 한번만 생성해주면 될 듯
* 벽 클릭 시 이동하지 않는데 가장 최단거리 노드로 이동하도록
* 다수의 노드를 배치한 후 타겟으로 동시에 이동
  * 스타 크래프트 유닛 이동처럼
  * 이를 위해 최단거리 노드 이동 로직 작성이 필수일 듯. 한 노드가 골을 선점하면 뒤따르는 노드들은 최단거리에 위치할 수 있도록
* 시작노드에서 타겟노드로 이동하는 중간에 클릭 이벤트가 발생하면 그 시점의 노드가 시작노드가 되고 새로운 타겟노드로 이동하는 로직 구현
```

이렇게 써보니 뭔가 2D 게임구현같은데 해보면 재미있을 것 같다.  

&nbsp;
### 구현

글을 쉽게 술술 쓰는 재주는 없으니 직접 구현한 데모와 함께 이만 줄인다...  
그나마 다행이라고 생각이 드는 점은 휴일을 완전히 반납하면서도 그다지 억울하거나 힘들지 않았다는 점?  
매거진에 수록된 퍼즐 문제를 푸는 기분으로 코드를 작성했다. 개발자가 어느정도 적성에 맞는다고 생각되는 부분...? :D  
와이프가 없었기에 가능했지만서도...  

&nbsp;&nbsp;&nbsp;

---


[A* 데모 보기](/experiment/astar)

![Image](/posts/astar/astar_sample_1.png)
